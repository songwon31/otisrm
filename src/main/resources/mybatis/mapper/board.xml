<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.finalteam5.otisrm.dao.BoardDao">
	<!-- 공지 등록 폼 -->
	<!-- 공지 등록 작성하기 -->
	<insert id="insertNtc" parameterType="NtcSubmit">
		insert into ntc (ntc_no, usr_no, ntc_ttl, ntc_conts, ntc_wrt_dt, ntc_mdfcn_dt, ntc_inq_cnt, ntc_emrg_yn)
		values((select NVL(MAX(ntc_no)+1,0)from ntc), #{usrNo}, #{ntcTtl}, #{ntcConts}, sysdate, 
		#{ntcMdfcnDt, jdbcType=DATE}, 0, #{ntcEmrgYn} )
	</insert>
	
	<!-- 최근 삽입한 공지사항 PK 불러오기(첨부파일 등록을 위함) -->
	<select id="selectAddNtcPk" resultType="String">
		select ntc_no from (
		  select * from ntc order by ntc_wrt_dt desc
		) where rownum = 1
	</select>
	
	<!-- 공지사항 첨부파일 업로드 -->
	<insert id="insertNtcAtch" parameterType="NtcAtch">
	     insert into ntc_atch(
	        ntc_atch_no, ntc_no, ntc_atch_nm, ntc_atch_mime_type,
	        ntc_atch_data, ntc_atch_size
	    ) values(
	        (select NVL(MAX(ntc_atch_no)+1,0)from ntc_atch), #{ntcNo, jdbcType=VARCHAR}, #{ntcAtchNm, jdbcType=VARCHAR},
	        #{ntcAtchMimeType, jdbcType=VARCHAR}, #{ntcAtchData, jdbcType=BLOB},
	        #{ntcAtchSize, jdbcType=NUMERIC}
	    )
	</insert>
</mapper>